##########################
# GLOBAL NETWORK
##########################
networks:
  proxy_net:
    external: true

services:
  gold-miner:
    build: ./
    container_name: gold-miner
    restart: always
    # ports:
    #   - "8121:8000"
    env_file:
      - ./.env
    command: ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000", "--reload", "--reload-dir", "app", "--reload-include", "*.env", "--proxy-headers", "--forwarded-allow-ips", "*"]
    volumes:
      - ./app:/app/app          # Source code only (for hot-reload)
      - ./.env:/app/.env        # Environment file (for hot-reload)
      - ./trading.db:/app/trading.db
      - ./logs:/app/logs
      - ./token_cache.json:/app/token_cache.json
    environment:
      - TZ=Asia/Seoul
    networks:
      - proxy_net
